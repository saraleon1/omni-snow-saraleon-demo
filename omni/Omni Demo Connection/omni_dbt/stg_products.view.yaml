# Reference this view as omni_dbt__stg_products
schema_label: ""
#This description was pulled from dbt.
description: Product (food and drink items that can be ordered) data with basic
  cleaning and transformation applied, one row per product.

schema: omni_dbt
table_name: STG_PRODUCTS

dimensions:
  product_id:
    sql: '"PRODUCT_ID"'
    format: ID
    #This description was pulled from dbt.
    description: The unique key for each product.

  product_name:
    sql: '"PRODUCT_NAME"'

  product_type:
    sql: '"PRODUCT_TYPE"'

  product_description:
    sql: '"PRODUCT_DESCRIPTION"'

  product_price:
    sql: '"PRODUCT_PRICE"'

  is_food_item:
    sql: '"IS_FOOD_ITEM"'

  is_drink_item:
    sql: '"IS_DRINK_ITEM"'

measures:
  count:
    aggregate_type: count

#The info below was pulled from your dbt repository and is read-only.
dbt:
  name: stg_products
  target_schema: dbt_sleon_prod
  description: Product (food and drink items that can be ordered) data with basic
    cleaning and transformation applied, one row per product.
  config:
    materialized: view
  code: |-
    with

    source as (

        select * from {{ source('dbt_sleon', 'raw_products') }}

    ),

    renamed as (

        select

            ----------  ids
            sku as product_id,

            ---------- text
            name as product_name,
            type as product_type,
            description as product_description,


            ---------- numerics
            {{ cents_to_dollars('price') }} as product_price,

            ---------- booleans
            coalesce(type = 'jaffle', false) as is_food_item,

            coalesce(type = 'beverage', false) as is_drink_item

        from source

    )

    select * from renamed
  referenced_by: [ products, order_items ]
